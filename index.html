<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página Exemplo - Acessibilidade</title>
    <!-- Bootstrap CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <!-- Custom CSS (Acessibilidade) -->
    <!-- INICIO DO BLOCO CSS DE ACESSIBILIDADE -->
    <style>
    /* ============================================================
       1. ESTILOS DO WIDGET (BOTÃO E MENU) - Z-INDEX MÁXIMO
       ============================================================ */
    .acessibilidade-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 2147483647; /* Garante que fique acima de tudo */
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        filter: none !important; /* Protege o botão dos filtros */
    }

    .button-access {
        background-color: #3288F2;
        border: none;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 16px;
        cursor: pointer;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        transition: transform 0.2s, background-color 0.2s;
    }

    .button-access:hover {
        transform: scale(1.1);
        background-color: #1c75e2;
    }

    .button-access .fa { font-size: 30px; }

    .dropdown {
        display: none;
        background-color: #f1f1f1;
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 0;
        margin-bottom: 15px;
        width: 220px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        overflow: hidden;
    }

    /* Hover apenas em telas grandes */
    @media (min-width: 768px) {
        .acessibilidade-container:hover .dropdown {
            display: block;
        }
    }

    .dropdown a {
        display: flex;
        align-items: center;
        padding: 10px 15px;
        text-decoration: none;
        color: #333;
        cursor: pointer;
        border-bottom: 1px solid #e0e0e0;
        background: #fff;
        transition: background 0.2s;
        font-family: Arial, sans-serif;
        font-size: 14px;
    }

    .dropdown a:hover { background-color: #e6e6e6; }
    .dropdown a:last-child { border-bottom: none; }
    .dropdown i { width: 25px; text-align: center; margin-right: 10px; color: #3288F2; }
    #menu-title { background-color: #3288F2; color: white; padding: 10px; font-weight: bold; text-align: center; }

    /* ============================================================
       2. CLASSES DE EFEITO (Aplicadas aos elementos do site)
       ============================================================ */
    
    .acessibilidade-grayscale { filter: grayscale(100%) !important; }
    .acessibilidade-contrast { filter: contrast(200%) !important; }
    
    /* O negativo precisa inverter e garantir fundo branco para virar preto */
    .acessibilidade-negative { 
        filter: invert(100%) !important; 
        background-color: #fff; 
    }

    /* Modificadores de Texto e Cor */
    .acessibilidade-light-mode { background-color: #FFF !important; color: #000 !important; }
    .acessibilidade-light-mode * { background-color: #FFF !important; color: #000 !important; border-color: #000 !important; }
    
    .acessibilidade-underline a { text-decoration: underline !important; }
    
    .acessibilidade-font { 
        font-family: Arial, Helvetica, sans-serif !important; 
        line-height: 1.5 !important; 
        letter-spacing: 0.5px !important; 
    }
    </style>
    <!-- FIM DO BLOCO CSS -->

</head>
<body>
    
    <!-- Conteúdo do Site Exemplo -->
    <main id="main-content" role="main">
        <div class="container mt-5">
            <div class="row">
                <div class="col-md-12 text-center">
                    <h1>Página Exemplo</h1>
                    <h2>Usando Bootstrap, CSS, Script e Font-Awesome</h2>
                    <p class="lead">Este texto serve para testar o aumento de fonte e os contrastes.</p>
                    <button class="btn btn-primary mb-3">Clique Aqui</button>
                    <div class="icon">
                        <i class="fab fa-facebook fa-2x mx-2"></i>
                        <i class="fab fa-twitter fa-2x mx-2"></i>
                        <i class="fab fa-instagram fa-2x mx-2"></i>
                        <i class="fab fa-linkedin fa-2x mx-2"></i>
                    </div>
                    <div class="mt-4">
                        <a href="#">Link de exemplo para sublinhado</a>
                    </div>
                </div>
            </div>
            
            <div class="row mt-5">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Bloco 1</h5>
                            <p class="card-text">Teste de cor e contraste em cartões.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Bloco 2</h5>
                            <p class="card-text">Teste de leitura de tela.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Bloco 3</h5>
                            <p class="card-text">Teste de inversão de cores (Negativo).</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- INICIO DO BLOCO HTML/JS DE ACESSIBILIDADE -->
    <div class="acessibilidade-container" id="acessibilidade-wrapper">
        <div class="dropdown" id="menu-options">
            <div id="menu-title">Acessibilidade</div>
            <a onclick="increaseText()"><i class="fas fa-text-height"></i> Aumentar texto</a>
            <a onclick="decreaseText()"><i class="fas fa-text-height"></i> Diminuir texto</a>
            <a onclick="resetText()"><i class="fas fa-sync-alt"></i> Redefinir texto</a>
            <a onclick="toggleReadableFont()"><i class="fas fa-font"></i> Fonte legível</a>
            <a onclick="tornarSiteCinza()"><i class="fas fa-barcode"></i> Escala de cinza</a>
            <a onclick="toggleContrast()"><i class="fas fa-adjust"></i> Alto Contraste</a>
            <a onclick="toggleNegative()"><i class="fas fa-eye"></i> Contraste Negativo</a>
            <a onclick="toggleLight()"><i class="fas fa-sun"></i> Fundo claro</a>
            <a onclick="toggleUnderline()"><i class="fas fa-underline"></i> Sublinhar Links</a>
            <a onclick="leitordeTela()"><i class="fas fa-volume-up"></i> Leitor de tela</a>
            <a onclick="resetSettings()"><i class="fas fa-trash-restore"></i> Redefinir Tudo</a>
        </div>
        <button class="button-access" id="menu-button" aria-label="Abrir menu de acessibilidade">
            <i class="fa fa-wheelchair"></i>
        </button>
    </div>

    <!-- Script de Acessibilidade -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        // --- 1. PREPARAÇÃO DO AMBIENTE ---
        var containerAcessibilidade = document.getElementById("acessibilidade-wrapper");
        
        // Move o Widget para o final do body para garantir que ele fique separado do resto
        if (containerAcessibilidade && containerAcessibilidade.parentNode !== document.body) {
            document.body.appendChild(containerAcessibilidade);
        }

        // --- 2. LÓGICA DO MENU (Abrir/Fechar) ---
        var button = document.getElementById("menu-button");
        var menu = document.getElementById("menu-options");
        var isMenuVisible = false;

        button.addEventListener("click", function(e) {
            e.stopPropagation();
            if (menu.style.display === "block") {
                menu.style.display = ""; 
                isMenuVisible = false;
            } else {
                menu.style.display = "block";
                isMenuVisible = true;
            }
        });

        document.addEventListener("click", function(event) {
            if (isMenuVisible && !containerAcessibilidade.contains(event.target)) {
                menu.style.display = "";
                isMenuVisible = false;
            }
        });

        // --- 3. LÓGICA DE FILTROS (Aplica em tudo MENOS no botão) ---
        function getSiteElements() {
            // Seleciona tudo que é filho direto do body, exceto o widget e tags de script/style
            return document.querySelectorAll('body > *:not(#acessibilidade-wrapper):not(script):not(style):not(link)');
        }

        var currentFontSize = 100;

        window.toggleFilter = function(filterClass) {
            var elements = getSiteElements();
            
            if (filterClass === 'acessibilidade-negative') {
                elements.forEach(el => {
                    el.classList.remove('acessibilidade-grayscale', 'acessibilidade-contrast');
                });
                
                var isActive = false;
                elements.forEach(el => {
                    isActive = el.classList.toggle(filterClass);
                });

                // Pinta o fundo do body de preto para combinar com o site negativo
                document.body.style.backgroundColor = isActive ? '#000' : '';
            } else {
                elements.forEach(el => el.classList.remove('acessibilidade-negative'));
                document.body.style.backgroundColor = '';

                if (filterClass === 'acessibilidade-grayscale') {
                    elements.forEach(el => el.classList.remove('acessibilidade-contrast'));
                }
                if (filterClass === 'acessibilidade-contrast') {
                    elements.forEach(el => el.classList.remove('acessibilidade-grayscale'));
                }

                elements.forEach(el => el.classList.toggle(filterClass));
            }
            saveState();
        };

        window.toggleEffect = function(effectClass) {
            var elements = getSiteElements();
            elements.forEach(el => el.classList.toggle(effectClass));
            saveState();
        };

        window.fontManager = function(action) {
            if (action === 'increase') currentFontSize += 10;
            if (action === 'decrease') currentFontSize -= 10;
            if (action === 'reset') currentFontSize = 100;

            if (currentFontSize < 70) currentFontSize = 70;
            if (currentFontSize > 200) currentFontSize = 200;

            document.body.style.fontSize = currentFontSize + "%";
            
            // Protege o ícone do botão de mudar de tamanho
            var btnIcon = document.querySelector('.button-access');
            if(btnIcon) btnIcon.style.fontSize = "16px"; 

            localStorage.setItem('acc_fontSize', currentFontSize);
        };

        window.leitordeTela = function() {
            window.speechSynthesis.cancel();
            var text = document.body.innerText;
            var utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'pt-BR';
            window.speechSynthesis.speak(utterance);
        };

        window.resetSettings = function() {
            var elements = getSiteElements();
            elements.forEach(el => {
                el.classList.remove(
                    'acessibilidade-grayscale', 'acessibilidade-contrast', 
                    'acessibilidade-negative', 'acessibilidade-light-mode', 
                    'acessibilidade-underline', 'acessibilidade-font'
                );
            });
            document.body.style.backgroundColor = '';
            document.body.style.fontSize = '';
            currentFontSize = 100;
            localStorage.removeItem('acc_classes');
            localStorage.removeItem('acc_fontSize');
            window.speechSynthesis.cancel();
        };

        // Atalhos
        window.tornarSiteCinza = function() { toggleFilter('acessibilidade-grayscale'); };
        window.toggleContrast = function() { toggleFilter('acessibilidade-contrast'); };
        window.toggleNegative = function() { toggleFilter('acessibilidade-negative'); };
        window.toggleLight = function() { toggleEffect('acessibilidade-light-mode'); };
        window.toggleUnderline = function() { toggleEffect('acessibilidade-underline'); };
        window.toggleReadableFont = function() { toggleEffect('acessibilidade-font'); };
        window.increaseText = function() { fontManager('increase'); };
        window.decreaseText = function() { fontManager('decrease'); };
        window.resetText = function() { fontManager('reset'); };

        // --- 4. CARREGAR ESTADO ---
        function saveState() {
            var activeClasses = [];
            var sampleElement = document.querySelector('body > div:not(#acessibilidade-wrapper)'); 
            if(sampleElement) {
                sampleElement.classList.forEach(cls => {
                    if(cls.startsWith('acessibilidade-')) activeClasses.push(cls);
                });
                localStorage.setItem('acc_classes', JSON.stringify(activeClasses));
            }
        }

        var savedSize = localStorage.getItem('acc_fontSize');
        if (savedSize) {
            currentFontSize = parseInt(savedSize);
            document.body.style.fontSize = currentFontSize + "%";
        }

        var savedClasses = JSON.parse(localStorage.getItem('acc_classes') || "[]");
        if (savedClasses.length > 0) {
            savedClasses.forEach(cls => {
                if (cls.includes('filter') || cls.includes('negative')) toggleFilter(cls);
                else toggleEffect(cls);
            });
        }
    });
    </script>
    
    <!-- VLibras -->
    <div vw class="enabled">
        <div vw-access-button class="active"></div>
        <div vw-plugin-wrapper>
            <div class="vw-plugin-top-wrapper"></div>
        </div>
    </div>
    <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
    <script>
        new window.VLibras.Widget('https://vlibras.gov.br/app');
    </script>

    <!-- Bootstrap CDN -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
